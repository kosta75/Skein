<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.skein.model.dao.NotificationDao">

	<!-- 사용자 알림 등록 -->
	<insert id="notificationReg" parameterType="kr.co.skein.model.vo.NotificationCommand">
		INSERT INTO Notifications VALUES(#{notificationSeq}, #{email}, #{isRead}, SYSDATE, #{notificationCode})
	</insert>

	<!-- 가장 큰 사용자알림 식별번호 얻기 -->
	<select id="getNotificationMaxSequence" resultType="Integer">
		SELECT NVL(MAX(NotificationSeq)+1,1) FROM Notifications
	</select>
	
	<!--  친구알림 등록  -->
	<insert id="friendshipNotificationReg" parameterType="kr.co.skein.model.vo.FriendshipNotificationCommand">
		INSERT INTO FriendshipNotification VALUES(#{friendshipNotificationSeq}, #{notificationSeq}, #{email}, #{friendEmail}, #{friendshipConfirm}) 
	</insert>
	
	<!-- 가장 큰 친구알림 식별번호 얻기 -->
	<select id="getFriendshipNotificationMaxSequence" resultType="Integer">
		SELECT NVL(MAX(FriendshipNotificationSeq)+1,1) FROM FriendshipNotification
	</select>
	
	<!-- 사용자 알림 조회  -->
	<select id="getNotifications" resultType="kr.co.skein.model.vo.NotificationCountCommand">
		SELECT NotificationCode, COUNT(*) AS groupCount FROM Notifications WHERE email = #{email} GROUP BY notificationcode
	</select>
	
</mapper>